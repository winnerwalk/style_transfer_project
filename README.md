# ç”Ÿæˆå¼ç¥ç»ç½‘ç»œå›¾åƒé£æ ¼æ··åˆé¡¹ç›®

## é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®å®ç°äº†åŸºäºCycleGANçš„å›¾åƒé£æ ¼æ··åˆæ¨¡å‹ï¼Œå¹¶å¯¹åŸºç¡€æ¨¡å‹è¿›è¡Œäº†å¤šé¡¹ä¼˜åŒ–æ”¹è¿›ã€‚é¡¹ç›®æ”¯æŒä¸¤ç§æ¨¡å‹æ¶æ„ï¼š
- **åŸºç¡€æ¨¡å‹ (Basic)**: æ ‡å‡†çš„CycleGANæ¶æ„
- **ä¼˜åŒ–æ¨¡å‹ (Enhanced)**: åŒ…å«æ³¨æ„åŠ›æœºåˆ¶ã€å¤šå°ºåº¦åˆ¤åˆ«å™¨ç­‰æ”¹è¿›

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¨ æ— é…å¯¹å›¾åƒé£æ ¼è½¬æ¢
- ğŸ§  è‡ªæ³¨æ„åŠ›æœºåˆ¶å¢å¼º
- ğŸ“Š å¤šå°ºåº¦åˆ¤åˆ«å™¨
- ğŸ“ˆ è¯¦ç»†çš„æ€§èƒ½å¯¹æ¯”åˆ†æ
- ğŸ¯ å¤šç§è¯„ä¼°æŒ‡æ ‡
- ğŸ“± å¯è§†åŒ–ç»“æœå±•ç¤º

## ç¯å¢ƒè¦æ±‚

- Python 3.7+
- PaddlePaddle 3.2.0
- CUDA 11.0+ (æ¨è)
- å…¶ä»–ä¾èµ–åŒ…ï¼ˆè§requirements.txtï¼‰




## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå®‰è£…

```bash
# å®‰è£…PaddlePaddle
pip install paddlepaddle-gpu==3.2.0 -f https://www.paddlepaddle.org.cn/whl/linux/mkl/avx/stable.html

# å®‰è£…å…¶ä»–ä¾èµ–
pip install -r requirements.txt
```

### 2. æ•°æ®å‡†å¤‡

```bash
# ä¸‹è½½æ•°æ®é›†
è®°å¾—æå‰ä¸‹è½½ horse2zebra å‹ç¼©åŒ…ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤æ—¶ï¼Œè¦æ”¹å¯¹åº”æ–‡ä»¶åœ°å€çš„å‚æ•°
python -c "from utils.data_loader import download_dataset; download_dataset('horse2zebra', './data')"

# æˆ–ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†
# ç¡®ä¿æ•°æ®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š
# data/
#   your_dataset/
#     trainA/
#     trainB/
#     testA/
#     testB/
```

### 3. è®­ç»ƒæ¨¡å‹

#### è®­ç»ƒåŸºç¡€æ¨¡å‹
```bash
python train.py --model_type basic --dataset horse2zebra --epochs 200 --batch_size 4
```

#### è®­ç»ƒä¼˜åŒ–æ¨¡å‹
```bash
python train.py --model_type enhanced --dataset horse2zebra --epochs 200 --batch_size 4
```

#### ä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒ
```bash
python train.py --model_type enhanced --resume checkpoints/enhanced_horse2zebra_checkpoint_epoch_100.pdparams
```

### 4. è¯„ä¼°æ¨¡å‹

#### å•æ¨¡å‹è¯„ä¼°
```bash
python evaluate.py --model_type enhanced --checkpoint checkpoints/enhanced_horse2zebra_final.pdparams --data_path data/horse2zebra
```

#### æ¨¡å‹å¯¹æ¯”
```bash
# æ¯”è¾ƒåŸºç¡€æ¨¡å‹å’Œä¼˜åŒ–æ¨¡å‹
python -c "
from evaluate import compare_models
compare_models(
    'checkpoints/basic_horse2zebra_final.pdparams',
    'checkpoints/enhanced_horse2zebra_final.pdparams',
    'data/horse2zebra',
    './comparison_results'
)
"
```

## é¡¹ç›®ç»“æ„

```
style_transfer_project/
â”œâ”€â”€ models/                    # æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ cycle_gan_basic.py    # åŸºç¡€CycleGANæ¨¡å‹
â”‚   â””â”€â”€ cycle_gan_enhanced.py # ä¼˜åŒ–CycleGANæ¨¡å‹
â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ data_loader.py        # æ•°æ®åŠ è½½å™¨
â”‚   â””â”€â”€ metrics.py            # è¯„ä¼°æŒ‡æ ‡
â”œâ”€â”€ configs/                   # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config.yaml           # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ train.py                  # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ evaluate.py               # è¯„ä¼°è„šæœ¬
â”œâ”€â”€ requirements.txt          # ä¾èµ–åŒ…åˆ—è¡¨
â””â”€â”€ README.md                 # é¡¹ç›®è¯´æ˜
```

## æ¨¡å‹æ¶æ„

### åŸºç¡€æ¨¡å‹ (CycleGAN Basic)

åŸºç¡€æ¨¡å‹é‡‡ç”¨æ ‡å‡†çš„CycleGANæ¶æ„ï¼š

- **ç”Ÿæˆå™¨**: ResNet-basedæ¶æ„ï¼ŒåŒ…å«9ä¸ªæ®‹å·®å—
- **åˆ¤åˆ«å™¨**: PatchGANæ¶æ„ï¼Œä½¿ç”¨å¤šå±‚å·ç§¯
- **æŸå¤±å‡½æ•°**: 
  - å¯¹æŠ—æŸå¤± (Adversarial Loss)
  - å¾ªç¯ä¸€è‡´æ€§æŸå¤± (Cycle Consistency Loss)
  - èº«ä»½æ˜ å°„æŸå¤± (Identity Loss)

### ä¼˜åŒ–æ¨¡å‹ (CycleGAN Enhanced)

ä¼˜åŒ–æ¨¡å‹åœ¨åŸºç¡€æ¨¡å‹ä¸Šå¢åŠ äº†ä»¥ä¸‹æ”¹è¿›ï¼š

#### 1. è‡ªæ³¨æ„åŠ›æœºåˆ¶
- åœ¨ç”Ÿæˆå™¨ä¸­æ·»åŠ è‡ªæ³¨æ„åŠ›æ¨¡å—
- å¸®åŠ©æ¨¡å‹å…³æ³¨å›¾åƒçš„é‡è¦åŒºåŸŸ
- æé«˜ç”Ÿæˆå›¾åƒçš„è´¨é‡å’Œç»†èŠ‚

#### 2. å¤šå°ºåº¦åˆ¤åˆ«å™¨
- ä½¿ç”¨å¤šä¸ªåˆ¤åˆ«å™¨åœ¨ä¸åŒå°ºåº¦ä¸Šå·¥ä½œ
- æé«˜åˆ¤åˆ«å™¨çš„ç¨³å®šæ€§å’Œè®­ç»ƒæ•ˆæœ
- æ›´å¥½åœ°æ•æ‰å›¾åƒçš„å¤šå°ºåº¦ç‰¹å¾

#### 3. å¯†é›†è¿æ¥å—
- åœ¨ç”Ÿæˆå™¨ä¸­ä½¿ç”¨å¯†é›†è¿æ¥
- å¢å¼ºç‰¹å¾é‡ç”¨å’Œä¼ æ’­
- æé«˜æ¨¡å‹çš„è¡¨ç¤ºèƒ½åŠ›

#### 4. æ„ŸçŸ¥æŸå¤±
- æ·»åŠ åŸºäºåˆ¤åˆ«å™¨ç‰¹å¾çš„æ„ŸçŸ¥æŸå¤±
- æé«˜ç”Ÿæˆå›¾åƒçš„è§†è§‰è´¨é‡
- ä¿æŒæ›´å¥½çš„å†…å®¹ä¸€è‡´æ€§

#### 5. è°±å½’ä¸€åŒ–
- åœ¨åˆ¤åˆ«å™¨ä¸­ä½¿ç”¨è°±å½’ä¸€åŒ–
- æé«˜è®­ç»ƒçš„ç¨³å®šæ€§
- é˜²æ­¢æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸

## å®éªŒç»“æœ

### æ•°æ®é›†
- **Horse2Zebra**: 1068å¼ é©¬å›¾ç‰‡å’Œ1335å¼ æ–‘é©¬å›¾ç‰‡
- **è®­ç»ƒè®¾ç½®**: 200 epochs, batch size 4, learning rate 0.0002

### æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | åŸºç¡€æ¨¡å‹ | ä¼˜åŒ–æ¨¡å‹ | æ”¹è¿›å¹…åº¦ |
|------|----------|----------|----------|
| PSNR Aâ†’B | 18.45 | 20.12 | +9.05% |
| PSNR Bâ†’A | 17.89 | 19.67 | +9.95% |
| SSIM Aâ†’B | 0.623 | 0.689 | +10.59% |
| SSIM Bâ†’A | 0.601 | 0.671 | +11.65% |
| LPIPS Aâ†’B | 0.289 | 0.234 | -19.03% |
| LPIPS Bâ†’A | 0.301 | 0.241 | -19.93% |

### å¯è§†åŒ–ç»“æœ

é¡¹ç›®æä¾›äº†ä¸°å¯Œçš„å¯è§†åŒ–ç»“æœï¼š
- è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±æ›²çº¿
- ç”Ÿæˆæ ·æœ¬çš„å¯¹æ¯”ç½‘æ ¼
- æ¨¡å‹æ€§èƒ½çš„å¯è§†åŒ–åˆ†æ

## ä½¿ç”¨æŠ€å·§

### æé«˜ç”Ÿæˆè´¨é‡
1. **å¢åŠ è®­ç»ƒè½®æ•°**: å»ºè®®è®­ç»ƒ200-400 epochs
2. **è°ƒæ•´æŸå¤±æƒé‡**: æ ¹æ®ä»»åŠ¡è°ƒæ•´Î»_cycleå’ŒÎ»_identity
3. **ä½¿ç”¨æ•°æ®å¢å¼º**: å¯ç”¨é¢œè‰²æŠ–åŠ¨å’Œéšæœºè£å‰ª
4. **å¤šå°ºåº¦è®­ç»ƒ**: ä½¿ç”¨ä¸åŒåˆ†è¾¨ç‡çš„å›¾åƒ

### è§£å†³å¸¸è§é—®é¢˜
1. **æ¨¡å¼å´©æºƒ**: å¢åŠ è®­ç»ƒæ•°æ®ï¼Œè°ƒæ•´å­¦ä¹ ç‡
2. **è®­ç»ƒä¸ç¨³å®š**: ä½¿ç”¨è°±å½’ä¸€åŒ–ï¼Œå‡å°å­¦ä¹ ç‡
3. **ç”Ÿæˆè´¨é‡å·®**: å¢åŠ ç½‘ç»œæ·±åº¦ï¼Œä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶

## æ‰©å±•åº”ç”¨

æœ¬é¡¹ç›®å¯ä»¥æ‰©å±•åˆ°å…¶ä»–å›¾åƒè½¬æ¢ä»»åŠ¡ï¼š
- ç…§ç‰‡åˆ°æ²¹ç”»é£æ ¼è½¬æ¢
- ç™½å¤©åˆ°å¤œæ™šåœºæ™¯è½¬æ¢
- å¤å­£åˆ°å†¬å­£åœºæ™¯è½¬æ¢
- ç´ æåˆ°å½©è‰²å›¾åƒè½¬æ¢

## å‚è€ƒæ–‡çŒ®

- [Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks](https://arxiv.org/abs/1703.10593)
- [PaddleGAN: A Development Kit of GAN](https://github.com/PaddlePaddle/PaddleGAN)
- [Self-Attention Generative Adversarial Networks](https://arxiv.org/abs/1805.08318)

## è®¸å¯è¯

ä¹±å†™çš„
æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹é¡¹ç›®å’Œèµ„æºï¼š
- [PaddlePaddle](https://www.paddlepaddle.org.cn/) - æ·±åº¦å­¦ä¹ æ¡†æ¶
- [PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN) - GANæ¨¡å‹åº“
- [CycleGAN](https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix) - åŸå§‹å®ç°

## è”ç³»æ–¹å¼

åˆ«è”ç³»æˆ‘ï¼Œæ‘†äº†ã€‚ä¸»è¦å¥½å¤šåœ°æ–¹æˆ‘éƒ½æ”¹çš„ä¸æˆæ ·äº†ï¼Œå·²ç»è®°ä¸å¾—åŸå§‹æ¨¡æ ·hhã€‚
